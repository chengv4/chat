import{E as e,_ as t}from"./index-DHYFN0O-.js";import{E as a}from"./el-button-BAOBed78.js";import{_ as o,E as l,a as s}from"./el-message-box-DU-JRCiP.js";import{u as r}from"./index-G2CrvVt0.js";import{_ as i,r as p,f as n,a2 as m,w as c,M as d,u,o as f,D as g,I as j,V as v}from"./vendor-BExUNkqn.js";import{M as x}from"./index-0HhnWnYQ.js";import"./el-input-DmrRqaBg.js";import"./el-overlay-BzHcv2Hk.js";import"./utils-CNKHhdMi.js";import"./index-CuRgrL4S.js";import"./index-oYM0YY2M.js";import"./index-D2oWfImC.js";import"./index-BAdl-o9H.js";import"./el-select-BiJ0sI6a.js";import"./el-popper-BHsI4o1z.js";import"./error-D_Dr4eZ1.js";import"./event-BwRzfsZt.js";import"./scroll-NsgHiu6A.js";import"./debounce-2EaHwHzs.js";import"./index-CsIBGGrO.js";import"./el-tooltip-zxnoHQEE.js";import"./el-form-item-CXvwCL8v.js";import"./wangeditor-DBHRtTKh.js";import"./url-DjwWyOfx.js";import"./index-CQghRtY_.js";const y=t({__name:"PageAdmin",setup(t){const y=r(),{pageList:b,pagination:h}=i(y),w=p(null),C=p({}),D=[{type:"input",label:"页面名称",prop:"name"},{type:"query"},{type:"reset"},{render:()=>g(a,{type:"primary",onClick:()=>P({},"add")},{default:()=>[j("新增")]})}],E=n((()=>({total:b.value.total,list:b.value.list}))),_=[{prop:"name",label:"页面名称",align:"center",width:"300",render:({row:t,column:a,index:o})=>g("div",{class:"name-group"},[g("div",{style:"max-width: 120px;white-space: nowrap;overflow: hidden;text-overflow:ellipsis;"},[t.name]),g("span",{class:"icon-group"},[g(e,{title:"编辑"},{default:()=>[g(v("EditPen"),{color:"#409eff",onclick:()=>P(t,"edit")},null)]}),g(e,{title:"删除"},{default:()=>[g(v("Delete"),{color:"red",onclick:()=>M(t)},null)]})])])},{prop:"pageType",label:"页面类型",align:"center"},{prop:"content",label:"页面内容",align:"center",render:({row:e})=>g(a,{type:"text",onclick:()=>q(e)},{default:()=>[j("预览")]})}],k=m([{label:"页面类型",prop:"pageType",type:"select",rules:[{required:!0}],options:[{label:"富文本",value:"1"},{label:"vue组件",value:"2"}]},{label:"页面名称",prop:"name",type:"input",rules:[{required:!0}]},{label:"页面代码",prop:"component",type:"input",rules:[{required:!0}]},{label:"页面内容",prop:"content",type:"richEditor"},{label:"显示/隐藏",prop:"show",type:"switch"}]),P=(e,t)=>{"add"===t&&(C.value={show:!0}),"edit"===t&&(C.value={...e}),l({title:"新增/编辑",closeOnClickModal:!1,customClass:"custom-message-box",message:()=>g(s,{ref:w,formModel:C,formItems:k},null),beforeClose:(e,t,a)=>{if("confirm"===e){if(w.value){const e=w.value.form,t=w.value.formData||{};e.validate((e=>{e&&y.savePage(t).then((e=>{0===e.code&&a()}))}))}}else a()}})},q=e=>{const t=e.contentHtml||e.content;l({title:e.name||"",closeOnClickModal:!1,customClass:"custom-message-box",message:()=>g(x,{modelValue:t,"onUpdate:modelValue":e=>t=e},null)})},M=e=>{l({title:"",message:"确定要删除吗？",type:"warning"}).then((t=>{"confirm"===t&&y.deletePage(e)}))};return c((()=>C.value.pageType),(()=>{k.forEach((e=>{if("content"===e.prop){const t=C.value.pageType;e.type="2"===t?"textarea":"richEditor",e.placeholder="2"===t?"请输入组件代码":""}}))})),(e,t)=>(f(),d(o,{class:"page-admin",tableData:E.value,tableColumns:_,showPagination:"",showSort:"","default-expand-all":"",fetchDataAction:u(y).getPages,searchItems:D,pagination:u(h)},null,8,["tableData","fetchDataAction","pagination"]))}},[["__scopeId","data-v-4f2fc713"]]);export{y as default};
